---
title: 기계학습의 개념
author: hwang
date: 2024-05-15 17:00:00 +0900
categories: [Machine Learning]
tags: [machine learning, supervised learning, unsupervised learning]     # TAG names should always be lowercase
math: true
---

## 기계학습이란?

-  1959년, 아서 사무엘이 "기계가 일일이 코드로 명시하지 않은 동작을 데이터로부터 학습하여 실행할 수 있도록 하는 알고리즘을 개발하는 연구 분야"라고 정의

- 현대의 기계학습 — 경험을 통해 자동으로 개선하는 알고리즘의 연구

- **훈련데이터로 학습하지만 새로운 데이터로 일반화** — 학습을 위해 데이터와 학습 모델이 필요

- 데이터를 효과적으로 새로 정의해서 학습 모델에 입력해야 함(특성 선택 (feature selection), 특성 추출 (feature extraction))


## 지도학습 (Supervised Learning)

- 입력 데이터에 대해 정확한 출력을 예측하는 학습, **입력 데이터**와 **출력 레이블**이 주어진 상태에서 학습을 진행 

- 입력 데이터: 모델이 학습할 특성이나 설명 변수

- 촐력 레이블: 각 입력 데이터에 대응하는 정답 혹은 목표 값



### 지도학습의 두 가지 범주

**분류(Classification)**: 데이터가 속하는 범주(Category) 혹은 클래스를 예측

> 유한한 클래스에서 하나의 특정 클래스, 혹은 레이블을 하나의 관측값에 할당, **응답 변수가 번주형 변수**

#### MNIST Database

- 손으로 쓴 숫자들로 이루어진 거대한 데이터베이스, 기계학습에서 화상 처리 시스템을 훈련하기 위해 사용

- 훈련 세트 (앞쪽 60,000개), 테스트 세트 (뒤쪽 10,000개)로 구성

#### 정밀도

- 양성 예측의 정확도

- $$ {TP \over  TP + FP} $$

#### 재현율

- 분류기가 정확하게 감지한 양성 샘플의 비율

- $$ {TP \over  TP + FN} $$

- 진짜 양성 비율 = TNR, 거짓 양성 비율 = 1 - TNR

#### 다중분류

- 일대다 (one vs all) : 각 분류기의 결정 점수 중 가장 높은 것을 클래스로 선택

- 일대일 (one vs one) : 각 숫자의 조합마다 이진 분류기를 훈련



**회귀 (Regression)**: 연속적인 실수 값(continuous value)을 예측

> 예측하려는 값이 연속적이며, 특정 범위 내의 숫자로 표현됨, **응답 변수가 실수**

#### 선형 회귀

- 독립 변수와 종속 변수 사이의 관계를 모델링, 두 변수 사이의 관계가 직선으로 표현될 때, 이 직선을 데이터를 통해 찾아 종속 변수를 예측



### 지도학습의 과정

1. 데이터 준비

    입력 데이터 행렬(X)을 준비한다. X의 각 행은 하나의 관측값을 나타내고, 각 열은 예측 변수를 나타낸다. 응답 변수(Y)의 데이터형에는 숫자형, 문자열형등 다양하다. Y의 각 요소는 X의 행에 대한 응답 변수이다.

    > `회귀`을 수행할 때 Y는 X의 행 개수와 동일한 요소를 갖는 숫자형 벡터여야 한다.{: .prompt-info }

    > `분류`을 수행할 때 Y는 다음 데이터형 중 하나이다. 누락요소를 포함하는 방법을 나타낸다.{: .prompt-info }

    | 데이터형                      | 누락 요소        |
    | :--------------------------- | :--------------- |
    | 숫자형 벡터          | NaN     |
    | categorical형 벡터              | 	<undefined>    |
    | 문자형 배열 | 	공백 행 |
    | string형 배열 | 	<missing> 또는 "" |
    | 문자형 벡터로 구성된 셀형 배열 | 		'' |
    | 논리형 벡터 | 		(나타낼 수 없음) |

2. 알고리즘 선택

    알고리즘을 선택한다. **훈련 속도**, **메모리 사용량**, **예측 정확도**, **해석 가능성** 등을 고려하여 가능한 효율적인 알고리즘을 선택해야 한다.

3. 모델 피팅하기

    선택한 알고리즘에 따라 사용하는 피팅 함수가 결정된다.

    | 알고리즘                                    | 분류용 피팅 함수                            | 회귀용 피팅 함수                           |
    |------------------------------------------|------------------------------------------|------------------------------------------|
    | 결정 트리                                    | fitctree                                 | fitrtree                                 |
    | 판별분석                                    | fitcdiscr                                | 해당 없음                                   |
    | 앙상블 (예: 랜덤 포레스트 [1])                  | fitcensemble, TreeBagger                 | fitrensemble, TreeBagger                 |
    | 가우스 커널 모델                            | fitckernel (SVM 및 로지스틱 회귀 학습기)        | fitrkernel (SVM 및 최소제곱 회귀 학습기)         |
    | 가우스 과정 회귀 (GPR)                        | 해당 없음                                   | fitrgp                                   |
    | 일반화 가산 모델 (GAM)                        | fitcgam                                  | fitrgam                                  |
    | k-최근접이웃                                 | fitcknn                                  | 해당 없음                                   |
    | 선형 모델                                    | fitclinear (SVM 및 로지스틱 회귀)             | fitrlinear (SVM 및 최소제곱 회귀)              |
    | SVM 또는 기타 분류기용 다중클래스 오류 수정 출력 코드 (ECOC) 모델 | fitcecoc                                 | 해당 없음                                   |
    | 나이브 베이즈 모델                            | fitcnb                                   | 해당 없음                                   |
    | 신경망 모델                                  | fitcnet                                  | fitrnet                                  |
    | 서포트 벡터 머신 (SVM)                        | fitcsvm                                  | fitrsvm                                  |

4. 검증 방법 선택
    
    다음은 세 가지 기본 검증 방법이다.

    1. 재대입 오차 검토
    2. 교차 검증 오차 검토
    3. Out-of-bag 오차 검토

5. 피팅 검토 후 업데이트

    시간 복잡도와 공간 복잡도를 효율적으로 개선할 수 있다.

6. 피팅된 모델을 사용하여 예측

    predict 메서드를 사용하여 분류 응답 변수 혹은 회귀 응답 변수를 예측할 수 있다.
    ```python
    Ypredicted = predict(obj,Xnew)
    ```
    > `obj`는 피팅된 모델이다.{: .prompt-info }

    > `Xnew`는 새 입력 데이터이다.{: .prompt-info }

    > `Ypredicted`는 분류 응답, 혹은 회귀 응답이다.{: .prompt-info }

## 비지도학습

- 이미 찾아낸 특징과 찾아내지 못한 특징과의 관계를 찾는 학습

- **레이블**이 훈련데이터에 없음, 예측이 어려움

- 군집화, 연관, 차원 축소에 활용


### 군집화

- 레이블이 없는 데이터를 유사점, 혹은 차이점에 따라 그룹화하는 데이터 마이닝 기술

### 연관 규칙

- 특정 데이터 세트에서 변수 간의 관계를 발견하기 위한 규칙 기반 학습

### 차원 축소

- 특정 데이터 세트의 차원이 많을 때, 데이터 입력 횟수를 줄여 무결성을 보존하는 기법